<div class="wrap" *ngIf="roomId">

  <!-- ðŸŒŒ BACKGROUND -->
  <div class="bg"></div>
  <div class="orb orb1"></div>
  <div class="orb orb2"></div>

  <!-- HEADER -->
  <header class="header">
    <div class="left" (click)="openInfo()">
      <div class="avatar">
        {{ (room?.name || 'Group').slice(0,1).toUpperCase() }}
      </div>

      <div class="meta">
        <div class="name">{{ room?.name || 'Group' }}</div>
        <div class="sub">ðŸ‘¥ {{ room?.members?.length || 0 }} members</div>
      </div>
    </div>

    <button class="iconBtn" (click)="openInfo()">â„¹</button>
  </header>

  <!-- LOADING -->
  <div class="loading" *ngIf="loading">
    <div class="spinner"></div>
    Loading group chat...
  </div>

  <!-- âœ… MAIN SCROLL AREA -->
  <main class="msgs" #box *ngIf="!loading">

    <div
      *ngFor="let m of messages"
      class="bubble"
      [class.me]="m.senderId === myUid"
    >
      <div class="sender" *ngIf="m.senderId !== myUid">
        <span class="miniAv">{{ getInitial(m.senderId) }}</span>
        <span class="senderName">{{ getMemberName(m.senderId) }}</span>
      </div>

      <div class="text">{{ m.text }}</div>
    </div>

  </main>

  <!-- ERROR -->
  <div class="err" *ngIf="err">{{ err }}</div>

  <!-- COMPOSER -->
  <footer class="composer">
    <input
      [(ngModel)]="text"
      placeholder="Write a message..."
      (keydown.enter)="send()"
    />

    <button (click)="send()" [disabled]="!text.trim()">âž¤</button>
  </footer>

</div>
