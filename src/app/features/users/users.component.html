<div class="page">

  <!-- ğŸŒŒ Background -->
  <div class="bg"></div>
  <div class="orb orb1"></div>
  <div class="orb orb2"></div>

  <div class="wrap">

    <!-- HEADER -->
    <div class="header">
      <div class="hLeft">
        <h2>ğŸ‘¥ Users</h2>
        <p class="sub">Find people and start chatting instantly</p>
      </div>

      <div class="searchWrap">
        <span class="ico">ğŸ”</span>
        <input
          class="search"
          placeholder="Search by name / email / phone..."
          [(ngModel)]="searchText"
          (input)="onSearch()"
        />
      </div>
    </div>

    <!-- LOADING -->
    <div *ngIf="loading" class="loadingCard">
      <div class="spinner"></div>
      <div class="loadingText">Loading users...</div>
    </div>

    <!-- GRID -->
    <div class="grid" *ngIf="!loading">

      <!-- USERS LIST -->
      <div class="card listCard">
        <div class="cardTop">
          <div class="cardTopLeft">
            <h3>All Users</h3>
            <p class="miniSub">Tap user for details or start chat</p>
          </div>

          <!-- âœ… COUNT REMOVED -->
          <!-- <div class="pill">{{ filtered.length }}</div> -->
        </div>

        <div class="userList">

          <div class="userRow" *ngFor="let u of filtered">

          <div class="left" (click)="openDetails(u)">

            <!-- AVATAR -->
            <div class="avatar">

              <img
                *ngIf="u.photoURL"
                [src]="u.photoURL"
                class="avatar-img"
              />

              <span *ngIf="!u.photoURL">
                {{ (u.name || u.email || 'U')[0] | uppercase }}
              </span>

            </div>

            <!-- INFO -->
            <div class="info">
              <div class="name">{{ u.name || 'Unnamed' }}</div>
              <div class="sub2">{{ u.email || u.phone || 'No Email / Phone' }}</div>
            </div>

          </div>

  <!-- CHAT BUTTON -->
  <div class="actions">
    <button class="btn primary" (click)="startChat(u)">ğŸ’¬ Chat</button>
  </div>

</div>

      </div>

      <!-- DETAILS -->
      <div class="card" *ngIf="selectedUser">
        <div class="cardTop">
          <h3>ğŸ“Œ User Details</h3>
          <button class="xBtn" (click)="closeDetails()">âœ–</button>
        </div>

        <div class="detail">
          <div class="row">
            <span>UID</span>
            <b class="mono">{{ selectedUser.uid }}</b>
          </div>

          <div class="row">
            <span>Name</span>
            <b>{{ selectedUser.name || '-' }}</b>
          </div>

          <div class="row">
            <span>Email</span>
            <b>{{ selectedUser.email || '-' }}</b>
          </div>

          <div class="row">
            <span>Phone</span>
            <b>{{ selectedUser.phone || '-' }}</b>
          </div>
        </div>

        <div class="rowBtns">
          <button class="btn full primary" (click)="startChat(selectedUser)">ğŸ’¬ Start Chat</button>
          <button class="btn full ghost" (click)="closeDetails()">Close</button>
        </div>
      </div>

    </div>

  </div>
</div>
